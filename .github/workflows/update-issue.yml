name: Update issue
on:
  issues:
    types:
      - opened
      - reopened
      - edited
permissions:
  issues: write
env: 
 body: ${{ github.event.issue.body }}
jobs:
  Main:
   runs-on: ubuntu-latest 
   steps:
    - name: bruh
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'
    - uses: jannekem/run-python-script-action@v1
      name: run PY script
      with:
        script: |
          import os
          print("env body: " + os.environ["body"])
          new_body = os.environ["body"]
          new_body = new_body.replace("### [mod]", "[mod]")
          set_env("body", new_body)
    - name: Remove in-process label
      if: contains(github.event.issue.labels.*.name, 'in-process')
      run: gh issue edit "${{ github.event.issue.number }}" --remove-label in-process
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        GH_REPO: ${{ github.repository }}
            
    - name: Fix body
      run: gh issue edit "${{ github.event.issue.number }}" --body "${{ env.body }}"
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        GH_REPO: ${{ github.repository }}
